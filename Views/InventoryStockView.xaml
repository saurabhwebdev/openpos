<UserControl x:Class="MyWinFormsApp.Views.InventoryStockView"
             xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
             xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
             xmlns:materialDesign="http://materialdesigninxaml.net/winfx/xaml/themes">

    <ScrollViewer VerticalScrollBarVisibility="Auto" HorizontalScrollBarVisibility="Disabled">
        <StackPanel Margin="40,24,40,40">

            <!-- Stock Adjustment Card -->
            <materialDesign:Card Padding="24" UniformCornerRadius="12" Margin="0,0,0,16">
                <StackPanel>
                    <StackPanel Orientation="Horizontal" Margin="0,0,0,16">
                        <materialDesign:PackIcon Kind="SwapVertical" Width="20" Height="20"
                                                  VerticalAlignment="Center" Margin="0,0,10,0" Opacity="0.7"/>
                        <TextBlock Text="Stock Adjustment"
                                   Style="{StaticResource MaterialDesignSubtitle1TextBlock}"/>
                    </StackPanel>

                    <Grid>
                        <Grid.ColumnDefinitions>
                            <ColumnDefinition Width="*"/>
                            <ColumnDefinition Width="16"/>
                            <ColumnDefinition Width="*"/>
                        </Grid.ColumnDefinitions>
                        <Grid.RowDefinitions>
                            <RowDefinition Height="Auto"/>
                            <RowDefinition Height="Auto"/>
                            <RowDefinition Height="Auto"/>
                        </Grid.RowDefinitions>

                        <ComboBox x:Name="CmbProduct" Grid.Row="0" Grid.Column="0"
                                  Style="{StaticResource MaterialDesignOutlinedComboBox}"
                                  materialDesign:HintAssist.Hint="Select Product *"
                                  FontSize="14" Margin="0,0,0,12" DisplayMemberPath="Name" SelectedValuePath="Id"
                                  SelectionChanged="CmbProduct_SelectionChanged"/>

                        <ComboBox x:Name="CmbMovementType" Grid.Row="0" Grid.Column="2"
                                  Style="{StaticResource MaterialDesignOutlinedComboBox}"
                                  materialDesign:HintAssist.Hint="Movement Type *"
                                  FontSize="14" Margin="0,0,0,12">
                            <ComboBoxItem Content="Stock In" Tag="IN"/>
                            <ComboBoxItem Content="Stock Out" Tag="OUT"/>
                            <ComboBoxItem Content="Adjustment (Set to)" Tag="ADJUSTMENT"/>
                        </ComboBox>

                        <TextBox x:Name="TxtQuantity" Grid.Row="1" Grid.Column="0"
                                 Style="{StaticResource MaterialDesignOutlinedTextBox}"
                                 materialDesign:HintAssist.Hint="Quantity *"
                                 FontSize="14" Margin="0,0,0,12"/>

                        <TextBlock x:Name="TxtCurrentStock" Grid.Row="1" Grid.Column="2"
                                   FontSize="14" VerticalAlignment="Center" Opacity="0.6" Margin="8,0,0,12"/>

                        <TextBox x:Name="TxtReference" Grid.Row="2" Grid.Column="0"
                                 Style="{StaticResource MaterialDesignOutlinedTextBox}"
                                 materialDesign:HintAssist.Hint="Reference (Invoice/PO No.)"
                                 FontSize="14" Margin="0,0,0,12"/>

                        <TextBox x:Name="TxtNotes" Grid.Row="2" Grid.Column="2"
                                 Style="{StaticResource MaterialDesignOutlinedTextBox}"
                                 materialDesign:HintAssist.Hint="Notes"
                                 FontSize="14" Margin="0,0,0,12"/>
                    </Grid>

                    <StackPanel Orientation="Horizontal" Margin="0,4,0,0">
                        <Button x:Name="BtnSubmit" Style="{StaticResource MaterialDesignRaisedButton}"
                                Click="BtnSubmit_Click" Height="40" Margin="0,0,12,0">
                            <StackPanel Orientation="Horizontal">
                                <materialDesign:PackIcon Kind="Check" VerticalAlignment="Center" Margin="0,0,8,0"/>
                                <TextBlock Text="SUBMIT" VerticalAlignment="Center"/>
                            </StackPanel>
                        </Button>
                        <ProgressBar x:Name="ProgressSubmit" Style="{StaticResource MaterialDesignCircularProgressBar}"
                                     IsIndeterminate="True" Visibility="Collapsed" VerticalAlignment="Center"
                                     Width="28" Height="28"/>
                    </StackPanel>

                    <TextBlock x:Name="TxtMessage" FontSize="12" TextWrapping="Wrap" Margin="0,12,0,0" Visibility="Collapsed"/>
                </StackPanel>
            </materialDesign:Card>

            <!-- Recent Movements Card -->
            <materialDesign:Card Padding="24" UniformCornerRadius="12" Margin="0,0,0,16">
                <StackPanel>
                    <StackPanel Orientation="Horizontal" Margin="0,0,0,16">
                        <materialDesign:PackIcon Kind="History" Width="20" Height="20"
                                                  VerticalAlignment="Center" Margin="0,0,10,0" Opacity="0.7"/>
                        <TextBlock Text="Recent Stock Movements"
                                   Style="{StaticResource MaterialDesignSubtitle1TextBlock}"/>
                    </StackPanel>

                    <!-- Header -->
                    <Border BorderBrush="{DynamicResource MaterialDesignDivider}" BorderThickness="0,0,0,1" Padding="0,8">
                        <Grid>
                            <Grid.ColumnDefinitions>
                                <ColumnDefinition Width="*"/>
                                <ColumnDefinition Width="100"/>
                                <ColumnDefinition Width="80"/>
                                <ColumnDefinition Width="140"/>
                                <ColumnDefinition Width="120"/>
                                <ColumnDefinition Width="140"/>
                            </Grid.ColumnDefinitions>
                            <TextBlock Grid.Column="0" Text="Product" FontWeight="SemiBold" Opacity="0.6" FontSize="12"/>
                            <TextBlock Grid.Column="1" Text="Type" FontWeight="SemiBold" Opacity="0.6" FontSize="12"/>
                            <TextBlock Grid.Column="2" Text="Qty" FontWeight="SemiBold" Opacity="0.6" FontSize="12" HorizontalAlignment="Center"/>
                            <TextBlock Grid.Column="3" Text="Stock Change" FontWeight="SemiBold" Opacity="0.6" FontSize="12" HorizontalAlignment="Center"/>
                            <TextBlock Grid.Column="4" Text="Reference" FontWeight="SemiBold" Opacity="0.6" FontSize="12"/>
                            <TextBlock Grid.Column="5" Text="Date" FontWeight="SemiBold" Opacity="0.6" FontSize="12"/>
                        </Grid>
                    </Border>

                    <ItemsControl x:Name="MovementList">
                        <ItemsControl.ItemTemplate>
                            <DataTemplate>
                                <Border BorderBrush="{DynamicResource MaterialDesignDivider}" BorderThickness="0,0,0,1" Padding="0,8">
                                    <Grid>
                                        <Grid.ColumnDefinitions>
                                            <ColumnDefinition Width="*"/>
                                            <ColumnDefinition Width="100"/>
                                            <ColumnDefinition Width="80"/>
                                            <ColumnDefinition Width="140"/>
                                            <ColumnDefinition Width="120"/>
                                            <ColumnDefinition Width="140"/>
                                        </Grid.ColumnDefinitions>

                                        <TextBlock Grid.Column="0" Text="{Binding ProductName}" FontSize="13" VerticalAlignment="Center"/>

                                        <!-- Type Badge -->
                                        <Border Grid.Column="1" CornerRadius="4" Padding="6,2" VerticalAlignment="Center" HorizontalAlignment="Left">
                                            <Border.Style>
                                                <Style TargetType="Border">
                                                    <Setter Property="Background" Value="#E3F2FD"/>
                                                    <Style.Triggers>
                                                        <DataTrigger Binding="{Binding MovementType}" Value="IN">
                                                            <Setter Property="Background" Value="#E8F5E9"/>
                                                        </DataTrigger>
                                                        <DataTrigger Binding="{Binding MovementType}" Value="OUT">
                                                            <Setter Property="Background" Value="#FFEBEE"/>
                                                        </DataTrigger>
                                                    </Style.Triggers>
                                                </Style>
                                            </Border.Style>
                                            <TextBlock Text="{Binding MovementTypeDisplay}" FontSize="11" FontWeight="Medium">
                                                <TextBlock.Style>
                                                    <Style TargetType="TextBlock">
                                                        <Setter Property="Foreground" Value="#1565C0"/>
                                                        <Style.Triggers>
                                                            <DataTrigger Binding="{Binding MovementType}" Value="IN">
                                                                <Setter Property="Foreground" Value="#2E7D32"/>
                                                            </DataTrigger>
                                                            <DataTrigger Binding="{Binding MovementType}" Value="OUT">
                                                                <Setter Property="Foreground" Value="#C62828"/>
                                                            </DataTrigger>
                                                        </Style.Triggers>
                                                    </Style>
                                                </TextBlock.Style>
                                            </TextBlock>
                                        </Border>

                                        <!-- Quantity -->
                                        <TextBlock Grid.Column="2" Text="{Binding QuantityDisplay}" FontSize="13"
                                                   VerticalAlignment="Center" HorizontalAlignment="Center" FontWeight="SemiBold">
                                            <TextBlock.Style>
                                                <Style TargetType="TextBlock">
                                                    <Setter Property="Foreground" Value="#2E7D32"/>
                                                    <Style.Triggers>
                                                        <DataTrigger Binding="{Binding MovementType}" Value="OUT">
                                                            <Setter Property="Foreground" Value="#C62828"/>
                                                        </DataTrigger>
                                                    </Style.Triggers>
                                                </Style>
                                            </TextBlock.Style>
                                        </TextBlock>

                                        <!-- Stock Change -->
                                        <TextBlock Grid.Column="3" VerticalAlignment="Center" HorizontalAlignment="Center" FontSize="12" Opacity="0.6">
                                            <Run Text="{Binding PreviousStock, StringFormat={}{0:0.##}}"/>
                                            <Run Text="â†’"/>
                                            <Run Text="{Binding NewStock, StringFormat={}{0:0.##}}"/>
                                        </TextBlock>

                                        <TextBlock Grid.Column="4" Text="{Binding Reference}" FontSize="12" VerticalAlignment="Center" Opacity="0.6" TextTrimming="CharacterEllipsis"/>
                                        <TextBlock Grid.Column="5" Text="{Binding CreatedAt, StringFormat={}{0:dd MMM yyyy HH:mm}}" FontSize="11" VerticalAlignment="Center" Opacity="0.5"/>
                                    </Grid>
                                </Border>
                            </DataTemplate>
                        </ItemsControl.ItemTemplate>
                    </ItemsControl>

                    <ProgressBar x:Name="ProgressLoad" Style="{StaticResource MaterialDesignCircularProgressBar}"
                                 IsIndeterminate="True" Visibility="Collapsed" HorizontalAlignment="Center"
                                 Margin="0,20,0,0" Width="32" Height="32"/>

                    <TextBlock x:Name="TxtEmptyMovements" Text="No stock movements yet."
                               FontSize="12" Opacity="0.5" TextAlignment="Center" Margin="0,20,0,0" Visibility="Collapsed"/>
                </StackPanel>
            </materialDesign:Card>

        </StackPanel>
    </ScrollViewer>
</UserControl>
